[Rainmeter]
Update=60000
AccurateText=1
DynamicWindowSize=1

[Variables]
; === 在这里设置你的日期 ===
; 起始日期时间 (格式: YYYY-MM-DD HH:MM:SS, 24小时制)
StartDate=2025-12-01 09:00:00
; 截止日期时间 (格式: YYYY-MM-DD HH:MM:SS, 24小时制)
EndDate=2025-12-25 18:00:00

; === 外观设置 ===
; 进度条颜色阶段 (R,G,B,透明度)
BarColor1=100,200,100,255
BarColor2=255,200,50,255
BarColor3=255,50,50,255
; 背景颜色
BgColor=100,130,130,150
; 宽度和高度
W=300
H=12
; 字体大小
FontSize=9
; 文字颜色 (R,G,B,透明度)
TextColor=30,30,30,255
PercentColor=255,255,255,255
; 透明颜色 (完成后隐藏)
TransparentColor=255,0,0,255

; === 进度阶段分隔点设置 ===
; 第一阶段结束点 (百分比, 0-100, 小于此值使用 BarColor1)
Stage1End=25
; 第二阶段结束点 (百分比, 0-100, 大于 Stage1End 且小于此值使用 BarColor2)
Stage2End=75
; 第三阶段开始于 Stage2End

; ==========================
; 以下逻辑不需要修改
; ==========================

; 获取起始日期时间的时间戳
[MeasureStartTimestamp]
Measure=Time
TimeStamp=#StartDate#
TimeStampFormat=%Y-%m-%d %H:%M:%S

; 获取截止日期时间的时间戳
[MeasureEndTimestamp]
Measure=Time
TimeStamp=#EndDate#
TimeStampFormat=%Y-%m-%d %H:%M:%S

; 获取当前时间戳
[MeasureCurrentTimestamp]
Measure=Time

; 计算总小时数（将秒转换为小时）
[MeasureTotalHours]
Measure=Calc
Formula=(([MeasureEndTimestamp:Timestamp] - [MeasureStartTimestamp:Timestamp]) / 3600)

; 计算总天数（用于显示）
[MeasureTotalDays]
Measure=Calc
Formula=(MeasureTotalHours / 24)

; 计算已过小时数
[MeasureElapsedHours]
Measure=Calc
Formula=Max(0, ([MeasureCurrentTimestamp:Timestamp] - [MeasureStartTimestamp:Timestamp]) / 3600)

; 计算已过天数（用于显示）
[MeasureElapsedDays]
Measure=Calc
Formula=(MeasureElapsedHours / 24)

; 计算剩余小时数
[MeasureRemainingHours]
Measure=Calc
Formula=Max(0, ([MeasureEndTimestamp:Timestamp] - [MeasureCurrentTimestamp:Timestamp]) / 3600)

; 计算剩余天数（用于显示）
[MeasureRemainingDays]
Measure=Calc
Formula=(MeasureRemainingHours / 24)

; 计算进度百分比 (限制在 0-1 之间，基于小时精度)
[MeasureProgress]
Measure=Calc
Formula=Clamp(MeasureElapsedHours / Max(MeasureTotalHours, 1), 0, 1)

; 计算显示的百分比文字
[MeasurePercentText]
Measure=Calc
Formula=MeasureProgress * 100
MinValue=0
MaxValue=100

; 根据进度设置颜色
[MeasureColorStage]
Measure=Calc
Formula=MeasurePercentText
IfBelowValue=#Stage1End#
IfBelowAction=[!SetOption MeterBar BarColor "#BarColor1#"]
IfAboveValue=(#Stage1End# - 0.001)
IfAboveAction=[!SetOption MeterBar BarColor "#BarColor2#"]

[MeasureColorStage2]
Measure=Calc
Formula=MeasurePercentText
IfAboveValue=(#Stage2End# - 0.001)
IfAboveAction=[!SetOption MeterBar BarColor "#BarColor3#"]

[MeasureColorStage3]
Measure=Calc
Formula=MeasurePercentText
IfAboveValue=99.999
IfAboveAction=[!SetOption MeterBar BarColor "#TransparentColor#"]

[MeterBackground]
Meter=Image
W=#W#
H=#H#
SolidColor=#BgColor#
X=0
Y=0

[MeterBar]
Meter=Bar
MeasureName=MeasureProgress
W=#W#
H=#H#
BarColor=#BarColor2#
BarOrientation=Horizontal
X=0
Y=0

[MeterTimeInfo]
Meter=String
MeasureName=MeasureElapsedDays
MeasureName2=MeasureTotalDays
MeasureName3=MeasureRemainingDays
Text="%1 / %2 - %3 Day(s)"
FontColor=#TextColor#
FontSize=#FontSize#
AntiAlias=1
StringAlign=Left
X=5
Y=0
NumOfDecimals=1

[MeterPercent]
Meter=String
MeasureName=MeasurePercentText
Text="%1%"
FontColor=#PercentColor#
FontSize=#FontSize#
AntiAlias=1
StringAlign=Right
X=(#W# - 5)
Y=0
NumOfDecimals=1
